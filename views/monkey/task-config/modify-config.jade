extends ../../base/site-layout

block append head


block content
    h3#title ä¿®æ”¹é…ç½®
    hr

    #errMsg
        if errMsg
            pre= errMsg

    div.section
        div(style="padding: 0;")
            dl.dl-horizontal(style="margin-bottom: 5px")
                dt(style="text-align: left; width: 80px")
                   big= 'äº§å“'
                dd#product(style="margin-left: 100px")= config.get('product_name')
        div(style="padding: 0;")
            dl.dl-horizontal(style="margin-bottom: 5px")
                dt(style="text-align: left; width: 80px")
                    big= 'ä»»åŠ¡'
                dd#taskName(style="margin-left: 100px")= config.get('task_name')
    div.divider
    html.
        <div>
        <form>

            <div class="section">
                <h4 class="header">å¸¸ä¿®æ”¹é…ç½®</h4>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="appname" class="validate" type="text" placeholder="å¦‚: com.tencent.mqq" style="color: black">
                        <label for="appname">APPåŒ…å</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="svnPath" class="validate" type="text" placeholder="å¦‚: http://tc-svn.tencent.com/basic/basic_androidqq_rep/AndroidQQ_Lite_proj/trunk/QQLite/">
                        <label for="svnPath">SVNè·¯å¾„</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="remindRTX" class="validate" type="text" placeholder="å¤šä¸ªäººç”¨åˆ†å·éš”å¼€. å¦‚: zhangsan;tinyhua">
                        <label for="remindRTX">RTXæé†’äºº</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="packagePattern" class="validate" type="text" placeholder="å¡«å†™å®‰è£…åŒ…çš„æ ‡è¯†(debug.apk, release.apk, æˆ–å…¶ä»–)">
                        <label for="packagePattern">å®‰è£…åŒ…æ ‡è¯†</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="rdmPath" class="validate" type="text" placeholder="å¦‚: http://rdm.oa.com/ci/product/0b729b17-6eb1-495b-a868-8bc6aabdc5bb/job/3608">
                        <label for="rdmPath">RDMé“¾æ¥</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="rdmJobid" class="validate" type="text" placeholder="å¦‚: 3608">
                        <label for="rdmJobid">RDM Job ID</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="workspace_id" class="validate" type="text" placeholder="TAPD é¡¹ç›®ä¿¡æ¯æ¦‚å†µä¸­çš„<é¡¹ç›®ID>">
                        <label for="workspace_id">TAPD workspace id</label>
                    </div>
                </div>

                <div class='col-sm-5' style='margin-left: -15px; margin-bottom: 15px'>
                    <label for="product" style="text-align: left; min-width: 60px; padding: 0"> ANRæ˜¯å¦æå•åˆ°NewMonkeyçš„tapd </label>
                    <select id='AnrToNewMonkeyTapd' class='select2' style="min-width: 150px">
                        <option>æŒ‰æ‰‹Qè§„åˆ™</option>
                        <option>æ˜¯</option>
                        <option>å¦</option>
                    </select>
                </div>

                <div class="row col-sm-12">
                    <div class="switch">
                        <label>
                            <span style="font-size: 16px; margin-right: 15px; color: black">è¿ç»­æ¨¡å¼</span>å…³é—­
                            <input id="continue_mode" type="checkbox" checked>
                            <span class="lever"></span>
                            æ‰“å¼€
                        </label>
                    </div>
                </div>


                <div class="row col-sm-12">
                      <div class="switch">
                          <label>
                              <span style="font-size: 16px; margin-right: 15px; color: black">åå°æ•°æ®ä¸ŠæŠ¥</span>å…³é—­
                              <input id="report_data" type="checkbox">
                              <span class="lever"></span>
                              æ‰“å¼€
                          </label>
                      </div>
                </div>


                <div class="row col-sm-12">
                    <h5 style="text-align: center">ğŸŒº åé¢æ˜¯ä¸€äº›ä¸å¸¸ä¿®æ”¹çš„é…ç½® ~~~</h5>
                </div>
            </div>
        </form>

        </div>


        <div class="parallax-container" style="width: 100%">
            <div class="parallax"><img src="/static/public-img/background/house.jpg"></div>
        </div>


        <div>
            <div class="section">
                <h4 class="header">å…¶ä»–é…ç½®</h4>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="current_owner" type="text" placeholder="å¦‚æœæœ‰é…svnpathï¼Œåˆ™ç»™svnæœ€è¿‘ä¿®æ”¹äººï¼Œè‹¥æ²¡æ‰¾åˆ°ä¿®æ”¹äººï¼Œåˆ™ç›´æ¥ç»™<å½“å‰å¤„ç†äºº>">
                        <label for="current_owner">å½“å‰å¤„ç†äºº</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="version_report" type="text" placeholder="TAPDæå•çš„å¤§ç‰ˆæœ¬, æ¯”å¦‚ 6.5">
                        <label for="version_report">å‘ç°ç‰ˆæœ¬</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="priority" type="text" placeholder="ç°åº¦æ—¶å¯å¡« `urgent` (æ‰€æœ‰Crashéƒ½æç´§æ€¥å•), å‘å¸ƒåè¿™ä¸ªå­—æ®µæ”¹ä¸ºç©º">
                        <label for="priority">ä¼˜å…ˆçº§</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="loginactivity" type="text" placeholder="å¦‚: com.tencent.mobileqq.activity.LoginActivity">
                        <label for="loginactivity">éœ€è¦è¿›è¡Œç™»å½•çš„Activity</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="classname" type="text" placeholder="å¦‚: com.mobileqq.Login">
                        <label for="classname">éœ€è¦è¿è¡Œçš„ç±»</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="UinGroupName" type="text" placeholder="å¦‚æœä¸€ä¸ªè´¦å·ä¸èƒ½ç™»å½•å¤šå°æ‰‹æœºï¼Œè¯·å¡«QTAæµ‹è¯•è´¦å·åˆ†ç»„å, å¦‚ï¼šMobileQQ">
                        <label for="UinGroupName">è´¦æˆ·ç»„åç§°</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="UIN_PWD" type="text" placeholder="å¦‚æœä¸€ä¸ªè´¦å·èƒ½ç™»å½•å¤šå°æ‰‹æœºï¼Œè´¦å·å¯†ç ä¹‹é—´ç©ºæ ¼éš”å¼€, å¦‚: 2485992140 LaLa123">
                        <label for="UinGroupName">è´¦å· å¯†ç </label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="userDefinedLog" type="text" placeholder="å¯å¡«æ–‡ä»¶(å¤¹)çš„è·¯å¾„ï¼Œä¸ç”¨åŠ sdcardè·¯å¾„, ç”¨;åˆ†éš”ï¼Œä¸å¡«ä¸ºç©º, å¦‚: tencent/a.txt">
                        <label for="userDefinedLog">å–è‡ªå®šä¹‰ä¸Šä¼ æ–‡ä»¶è·¯å¾„</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <input id="monkeyoption" type="text" placeholder="å¦‚æœ‰Activityé»‘åå•ç­‰ç‰¹æ®Šé€‰é¡¹ç­‰, å¯è”ç³»NewMonkeyæˆå‘˜å¸®åŠ©é…ç½®">
                        <label for="monkeyoption">NewMonkey å¯åŠ¨å‚æ•°</label>
                    </div>
                </div>
            </div>



            <div class="section">
                <h4>æäº¤</h4>
                <div class="divider"></div>
                <div style="margin-top: 20px">
                    <p>
                        <input type="checkbox" class="validate" id="svn_permission"/>
                        <label style="color: firebrick" for="svn_permission">(è¯·ç¡®è®¤) æˆ‘å·²ç»ç»™ isd_webadmin åŠ SVNè¯»æƒé™</label>
                    </p>

                    <p>
                        <input type="checkbox" class="validate" id="RDM_TAPD_permission"/>
                        <label style="color: firebrick" for="RDM_TAPD_permission">(è¯·ç¡®è®¤) æˆ‘å·²ç»ç»™ looklukelu, janiceli, anthonytan å¼€é€šRDMåŠTAPDæƒé™</label>
                    </p>
                </div>

                <a class="waves-effect waves-light btn" style="text-align: center; width: 50%" onclick="do_submit()">æäº¤</a>
            </div>
        </div>

        <div class="parallax-container">
            <div class="parallax"><img src="/static/public-img/background/bridge.jpg"></div>
        </div>

block append script
    script.
        var url_task_list_of_product = '/monkey/getTaskConfigs/';
        var ulr_config_of_task_and_product = '/monkey/getTaskConfigs/';
        var url_submit_config = '/monkey/submitTaskConfig/';
        var url_when_submit_success = '/monkey/taskConfigList/';

        var task_config_notify_empty = "-- æ²¡æœ‰å“‡ --";
        var task_config_notify_normal = "-- é€‰æ‹©æ¥å‚è€ƒå…¶ä»–ä»»åŠ¡ --";


        var form_info = {
            'taskName': {
                'field': 'taskName',
                'name': 'ä»»åŠ¡å',
                "group": 'basic',
                'required': 'required',
                'placeholder': 'NewMonkeyä»»åŠ¡åç§°, åŒä¸€äº§å“æœ€å¥½æœ‰ç›¸åŒå‰ç¼€'
            },
            'appname': {
                'field': 'appname',
                'name': 'APPåŒ…å',
                "group": 'basic',
                'required': 'required',
                'placeholder': 'å¦‚: com.tencent.mqq'
            },
            "svnPath": {
                "field": "svnPath",
                "required": 'required',
                "group": 'basic',
                "placeholder": "å¦‚: http://tc-svn.tencent.com/basic/basic_androidqq_rep/AndroidQQ_Lite_proj/trunk/QQLite/",
                "name": "SVNè·¯å¾„"
            },
            "remindRTX": {
                "field": "remindRTX",
                "required": 'required',
                "group": 'basic',
                "placeholder": "å¤šä¸ªäººç”¨åˆ†å·éš”å¼€. å¦‚: zhangsan;tinyhua",
                "name": "RTXæé†’äºº"
            },
            "packagePattern": {
                "field": "packagePattern",
                "required": 'required',
                "group": 'basic',
                "placeholder": "å¡«å†™å®‰è£…åŒ…çš„æ ‡è¯†(debug.apk, release.apk, æˆ–å…¶ä»–)",
                "name": "å®‰è£…åŒ…æ ‡è¯†"
            },    // TODO: RDM éªŒè¯
            "rdmPath": {
                "field": "rdmPath",
                "required": 'required',
                "group": 'basic',
                "placeholder": "å¦‚: http://rdm.oa.com/ci/product/0b729b17-6eb1-495b-a868-8bc6aabdc5bb/job/3608",
                "name": "RDMé“¾æ¥"
            },
            "rdmJobid": {
                "field": "rdmJobid",
                "required": 'required',
                "group": 'basic',
                "placeholder": "å¦‚: 3608",
                "name": "RDM Job ID"
            },
            "workspace_id": {
                "field": "workspace_id",
                "required": 'required',
                "group": 'basic',
                "placeholder": "TAPD é¡¹ç›®ä¿¡æ¯æ¦‚å†µä¸­çš„<é¡¹ç›®ID>",
                "name": "TAPD workspace id"
            },
            "continue_mode": {
                "field": "continue_mode",
                "required": '',
                "group": 'basic',
                "placeholder": "'true' æˆ–è€… 'false'",
                "name": "å¯ç”¨è¿ç»­æ€",
                "field_type": "checkbox_false"
            },
            "report_data": {
                "field": "report_data",
                "required": '',
                "group": 'basic',
                "placeholder": "'true' æˆ–è€… 'false'",
                "name": "åå°æ•°æ®ä¸ŠæŠ¥",
                "field_type": "checkbox_false"
            },
            "tapdPath": {
                "field": "tapdPath",
                "required": '',
                "group": 'hide',
                "placeholder": "å¦‚: http://tapd.oa.com/androidQQ/bugtrace/bugreports/my_view",
                "name": "TAPDè‡ªåŠ¨æå•åœ°å€"
            },
            "current_owner": {
                "field": "current_owner",
                "required": '',
                "group": '',
                "placeholder": "å¦‚æœæœ‰é…svnpathï¼Œåˆ™ç»™svnæœ€è¿‘ä¿®æ”¹äººï¼Œè‹¥æ²¡æ‰¾åˆ°ä¿®æ”¹äººï¼Œåˆ™ç›´æ¥ç»™<å½“å‰å¤„ç†äºº>",
                "name": "å½“å‰å¤„ç†äºº"
            },
            "version_report": {
                "field": "version_report",
                "required": '',
                "group": '',
                "placeholder": "TAPDæå•çš„å¤§ç‰ˆæœ¬, æ¯”å¦‚ 6.5",
                "name": "å‘ç°ç‰ˆæœ¬"
            },
            "feature": {
                "field": "feature",
                "required": '',
                "group": 'hide',
                "placeholder": "TAPD feature å­—æ®µ, å¦‚: MobileQQ_VIP, ç”¨äºåŒºåˆ«åŒä¸€äº§å“çš„ä¸åŒæµ‹è¯•ä»»åŠ¡",
                "name": "feature"
            },
            "module": {
                "field": "module",
                "required": '',
                "group": 'hide',
                "placeholder": "TAPD module å­—æ®µ, å¦‚: MTTF",
                "name": "module"
            },
            "priority": {
                "field": "priority",
                "required": '',
                "group": '',
                "placeholder": "ç°åº¦æ—¶å¯å¡« `urgent` (æ‰€æœ‰Crashéƒ½æç´§æ€¥å•), å‘å¸ƒåè¿™ä¸ªå­—æ®µæ”¹ä¸ºç©º",
                "name": "priority"
            },
            "AnrToNewMonkeyTapd": {
                "field": "AnrToNewMonkeyTapd",
                "required": '',
                "group": '',
                'option_list': ["æŒ‰æ‰‹Qè§„åˆ™", "æ˜¯", "å¦"],
                "name": "ANRæ˜¯å¦æå•åˆ°NewMonkeyçš„tapd",
                "field_type": "select"
            },
            "AnrFocusPhone": {
                "field": "AnrFocusPhone",
                "required": '',
                "group": 'hide',
                "placeholder": "æŒ‰æ‰‹Qè§„åˆ™æ—¶å¡«å†™, å¦‚: MI 3;SCH-I939I;GT-I9508 (ä»¥è‹±æ–‡åˆ†å·;åˆ†éš”)",
                "name": "å…³æ³¨ANRçš„æœºå‹"
            },
            "appStartOption": {
                "field": "appStartOption",
                "required": '',
                "group": 'hide',
                "placeholder": "å¦‚ï¼šam start -n com.tencent.mobileqq/.activity.SplashActivity --ez logDBOperation true --ez autoDumpLeak true",
                "name": "App å¯åŠ¨å‚æ•°"
            },
            "MonkeyOptionForDiffPhone": {
                "field": "MonkeyOptionForDiffPhone",
                "group": 'hide',
                "required": '',
                "placeholder": "å¦‚ï¼š357070057309462=--activity2script com.tencent.mobileqq.activity.LoginActivity==-c##com.mobileqq.Login##-e##uin##896990074##-e##pwd##qqtest2014",
                "name": "NewMonkeyä¸åŒæ‰‹æœºé€‰é¡¹"
            },
            "loginactivity": {
                "field": "loginactivity",
                "required": '',
                "group": '',
                "placeholder": "å¦‚: com.tencent.mobileqq.activity.LoginActivity",
                "name": "éœ€è¦è¿›è¡Œç™»å½•çš„Activity"
            },
            "classname": {
                "field": "classname",
                "required": '',
                "group": '',
                "placeholder": "å¦‚: com.mobileqq.Login",
                "name": "éœ€è¦è¿è¡Œçš„ç±»"
            },
            "UinGroupName": {
                "field": "UinGroupName",
                "group": '',
                "required": '',
                "placeholder": "å¦‚æœä¸€ä¸ªè´¦å·ä¸èƒ½ç™»å½•å¤šå°æ‰‹æœºï¼Œè¯·å¡«QTAæµ‹è¯•è´¦å·åˆ†ç»„å, å¦‚ï¼šMobileQQ",
                "name": "è´¦æˆ·ç»„åç§°"
            },
            "UIN_PWD": {
                "field": "UIN_PWD",
                "required": '',
                "group": '',
                "placeholder": "å¦‚æœä¸€ä¸ªè´¦å·èƒ½ç™»å½•å¤šå°æ‰‹æœºï¼Œè´¦å·å¯†ç ä¹‹é—´ç©ºæ ¼éš”å¼€, å¦‚: 2485992140 LaLa123",
                "name": "è´¦å· å¯†ç "
            },
            "userDefinedLog": {
                "field": "userDefinedLog",
                "required": '',
                "group": '',
                "placeholder": "å¯å¡«æ–‡ä»¶(å¤¹)çš„è·¯å¾„ï¼Œä¸ç”¨åŠ sdcardè·¯å¾„, ç”¨;åˆ†éš”ï¼Œä¸å¡«ä¸ºç©º, å¦‚: tencent/a.txt",
                "name": "å–è‡ªå®šä¹‰ä¸Šä¼ æ–‡ä»¶è·¯å¾„"
            },
            "monkeyoption": {
                "field": "monkeyoption",
                "required": '',
                "group": '',
                "placeholder": "å¦‚æœ‰Activityé»‘åå•ç­‰ç‰¹æ®Šé€‰é¡¹ç­‰, å¯è”ç³»NewMonkeyæˆå‘˜å¸®åŠ©é…ç½®",
                "name": "NewMonkey å¯åŠ¨å‚æ•°"
            },
            "crashflag": {
                "field": "crashflag",
                "required": '',
                "group": 'hide',
                "placeholder": "å¦‚æœæœ‰ï¼Œè¯·å¡«å†™, å¦‚: E crash",
                "name": "Logcatä¸­Appè‡ªå®šä¹‰Crashæ ‡è¯†"
            },
            "LogcatCrashTypePattern": {
                "field": "LogcatCrashTypePattern",
                "group": 'hide',
                "required": '',
                "placeholder": "crashflag å¦‚æœè®¾ç½®ï¼Œè¯·å¡«å†™ï¼Œå¦‚: E crash\s*:\s*(\S*)(:\s*\S*)*",
                "name": "Logcatä¸­è·å–crashç±»å‹çš„æ­£åˆ™è¡¨è¾¾å¼"
            },
            "LogcatCrashHeapInfoPattern": {
                "field": "LogcatCrashHeapInfoPattern",
                "group": 'hide',
                "required": '',
                "placeholder": "crashflag å¦‚æœè®¾ç½®ï¼Œè¯·å¡«å†™ï¼Œå¦‚ï¼šE crash\s*:\s*at\s*(\S*\s\S*)",
                "name": "Logcatä¸­å–å †æ ˆä¿¡æ¯çš„æ­£åˆ™è¡¨è¾¾å¼"
            },
            "svn_permission": {
                "field": "svn_permission",
                "required": 'required',
                "group": '',
                "name": "æˆ‘å·²ç»ç»™ isd_webadmin åŠ SVNè¯»æƒé™",
                "field_type": "others"
            },
            "RDM_TAPD_permission": {
                "field": "RDM_TAPD_permission",
                "required": 'required',
                "group": '',
                "name": "æˆ‘å·²ç»ç»™ looklukelu, janiceli, anthonytan å¼€é€šRDMåŠTAPDæƒé™",
                "field_type": "others"
            }
        };

        /******** Document Part Start ********/
        function get_value_of_elem(elem) {
            if (!elem) {
                return '';
            }
            var $elem = $(elem);
            var tag = $elem.get(0).tagName;
            var value;
            if (tag == 'INPUT') {
                var type = $elem.attr('type');
                if (type == 'checkbox') {
                    value = $elem.is(':checked');
                } else {
                    value = $elem.val();
                }
            } else {
                value = $elem.text();
            }
            return value;
        }

        function set_value_of_elem(elem, value) {
            var $elem = $(elem);
            if (!$elem || ! $elem.get(0)) {
                console.log('not found elem: ' + elem + ', value: ' + value);
                return false;
            }
            var tag = $elem.get(0).tagName;
            if (tag == 'INPUT' || tag == 'SELECT') {
                var type = $elem.attr('type');
                if (type == 'checkbox') {
                    if (value != undefined) {
                        value = (value == 'checked' || value == true);
                        $elem.prop('checked', value);
                    }
                } else {
                    $elem.val(value);
                }
            } else {
                $elem.text(value);
            }
            return true;
        }

        function load_select_list(select_id, option_list, first_disabled) {
            var $select = $('#' + select_id);
            $select.empty();
            for (var i = 0; i < option_list.length; i++) {
                var option = option_list[i];
                if (first_disabled == true && i == 0)
                    $select.append('<option value="" disabled selected>' + option + '</option>');
                else
                    $select.append('<option>' + option + '</option>');
            }
            $select.trigger('change.select2');
        }

        /******** Ajax Part Start ********/

        function load_product_list() {
            show_loading('div_loading');
            $.ajax({
                url: url_get_product_list,
                type: "POST",
                dataType: 'json',
                data: {},
                success: function (resp) {
                    console.log(resp);
                    hide_loading('hide_loading');
                    if (resp.result != 'ok') {
                        Materialize.toast(resp.data, 30000);
                    } else {
                        var task_list = resp['datas'];
                        load_select_list('product', task_list);
                        load_task_list_of_product('#product_list');
                    }
                }
            });
        }

        function load_task_list_of_product() {
            var productName = $('#product').val();
            if (!productName)
                return;

            show_loading('div_loading');

            $.ajax({
                url: url_task_list_of_product,
                type: "GET",
                data: {
                    product: productName,
                    only_task_name: true
                },
                dataType: 'json',
                success: function (resp) {
                    hide_loading('div_loading');
                    if (resp.status != 'ok') {
                        Materialize.toast(resp.data, 30000);
                    } else {
                        var task_list = resp.data;
                        var task_name_list = task_list.map(function (x) {
                            return x['task_name'];
                        })
                        console.log(task_name_list);
                        if (task_name_list.length == 0)
                            task_name_list.unshift(task_config_notify_empty);
                        else {
                            task_name_list.unshift(task_config_notify_normal);
                        }
                        load_select_list('task_list', task_name_list, true);
                    }
                }
            });
        }


        function load_task_config_template() {
            var productName = get_value_of_elem('#product');
            var taskName = get_value_of_elem('#taskName');

            if (!taskName)
                return;

            show_loading('div_loading');

            $.ajax({
                url: ulr_config_of_task_and_product,
                type: "GET",
                dataType: 'json',
                data: {
                    'product': productName,
                    'task_name': taskName
                },
                success: function (resp) {
                    hide_loading('div_loading');
                    if (resp.status != 'ok') {
                        Materialize.toast(resp.data, 30000);
                    } else if (resp.data.length == 0) {
                        Materialize.toast('æœªæ‰¾åˆ°é…ç½®: äº§å“: ' + productName + ', ä»»åŠ¡: ' + taskName, 3000);
                    } else {
                        var config = resp.data[0].config;
                        delete config['taskName'];
                        do_clean_form();
                        do_load_task_config(config);
                    }
                }
            });
        }

        function do_clean_form() {
            do_load_task_config({
                "continue_mode": true,
                "AnrToNewMonkeyTapd": true
            });
        }

        function do_load_task_config(config) {
            console.log(config);
            for (var field in form_info) {
                if (!form_info.hasOwnProperty(field))
                    continue;
                set_value_of_elem($('#' + field), config[field]);
            }
        }

        function get_values_of_form(form_info) {
            var form_values = {};
            for (var field in form_info) {
                if (!form_info.hasOwnProperty(field))
                    continue;
                var elem = document.getElementById(field);
                form_values[field] = get_value_of_elem(elem);
                console.log(field + '__' + get_value_of_elem(elem));
            }
            return form_values;
        }

        function do_check() {
            var $validate = $('.validate');
            var is_ok = true;
            $validate.each(function (index) {
                var id = $(this).attr('id');
                var value = get_value_of_elem(this);
                var field_name = $(this).siblings('label').text();
                console.log(field_name);
                if (value == '' || value == false) {
                    is_ok = false;
                    Materialize.toast('è¯·æ£€æŸ¥æˆ–ç¡®è®¤: ' + field_name, 3000);
                    $('html, body').animate({
                        scrollTop: $("#" + id).offset().top - 100
                    }, 1000);
                    return false;
                }
            });
            return is_ok;
        }

        function do_submit() {
            var is_ok = do_check();
            if (!is_ok)
                return;
            var form_values = get_values_of_form(form_info);

            form_values['override_config'] = false;
            form_values['product'] = $('#product').text();
            console.debug(form_values);

            show_loading('div_loading');

            $.ajax({
                url: url_submit_config,
                type: "POST",
                async: false,
                dataType: 'json',
                data: {
                    'formJsonStr': JSON.stringify(form_values)
                },
                success: function (resp) {
                    console.log(resp);
                    hide_loading('div_loading');
                    if (resp.status != 'ok') {
                        Materialize.toast(resp.data, 30000);
                    } else {
                        Materialize.toast('æäº¤é…ç½®æˆåŠŸ', 4000, '', function () {
                              document.location = url_when_submit_success;
                        });
                    }
                }
            });
            return false;
        }

        $(document).ready(function () {
            $('.parallax').parallax();
            $('.select2').select2({minimumResultsForSearch: 7});
            load_task_config_template();
        });
