extends ../base/site-layout

block append head
    script(src='/static/monkey/js/stat-coverage.js')

block content
    h3#title 任务详情
    hr

    #errMsg
        if errMsg
            pre= errMsg


    div
        div(style="padding: 0;")
            dl.dl-horizontal(style="margin-bottom: 5px")
                dt(style="text-align: left")= 'Task ID'
                dd#task_id= task_info.task_id

        div(style="padding: 0;")
            dl.dl-horizontal(style="margin-bottom: 5px")
                dt(style="text-align: left")= '时长'
                dd#task_duration= 'Loading ...'

        div(style="padding: 0;")
            dl.dl-horizontal(style="margin-bottom: 5px")
                dt(style="text-align: left")= 'Activity 覆盖率'
                dd#task_acr= 'Loading ...'

        div(style="padding: 0;")
            dl.dl-horizontal(style="margin-bottom: 5px")
                dt(style="text-align: left")= '控件 覆盖率'
                dd#task_wcr= 'Loading ...'

        div(style="padding: 0;")
            dl.dl-horizontal(style="margin-bottom: 5px")
                dt(style="text-align: left")= '事件 覆盖率'
                dd#task_ecr= 'Loading ...'

        div(style="padding: 0;")
            dl.dl-horizontal(style="margin-bottom: 5px")
                dt(style="text-align: left")= '覆盖率趋势图'
                dd#timeline
                    a(href='/monkey/coverageTimeline?task_id=#{task_info.task_id}' target='_black') 点击链接查看

        include ./activity-network

        hr
        div#div_task_activity
            div
                button#btn_task_activity(type=button style="width: 200px; text-align: left" class='btn btn-info', data-toggle="collapse", data-target="#div_task_activity_list")
                    span.glyphicon.glyphicon-list
                    | &nbsp;&nbsp; 查看 Activity 详情
                div#div_task_activity_list(style="padding: 0;", class='collapse out')
                    h5 已覆盖 Activity
                    pre#cover_activity_list(style="margin-left: 30px")
                    div#div_sm_activity_list(style="padding: 0; margin: 0")
                        hr
                        h5 所有 Activity
                        pre#sm_activity_list(style="margin-left: 30px")

            hr(align='left' width='20%')
            div
                button#btn_task_widget(type=button style="width: 200px; text-align: left" class='btn btn-info', data-toggle="collapse", data-target="#div_task_widget_list")
                    span.glyphicon.glyphicon-list
                    | &nbsp;&nbsp; 查看 Widget 详情
                div#div_task_widget_list(style="padding: 0;", class='collapse out')
                    h5 已覆盖 Widget
                    pre#cover_widget_list(style="margin-left: 30px")
                    div#div_sm_widget_list(style="padding: 0; margin: 0")
                        hr
                        h5 所有 Widget
                        pre#sm_widget_list(style="margin-left: 30px")

                hr(align='left' width='20%')
                div
                    button#btn_task_event(type=button style="width: 200px; text-align: left" class='btn btn-info', data-toggle="collapse", data-target="#div_task_event_list")
                        span.glyphicon.glyphicon-list
                        | &nbsp;&nbsp; 查看 Event 详情
                    div#div_task_event_list(style="padding: 0;", class='collapse out')
                        h5 已覆盖 Event
                        pre#cover_event_list(style="margin-left: 30px")
                        div#div_sm_event_list(style="padding: 0; margin: 0")
                            hr
                            h5 所有 Event
                            pre#sm_event_list(style="margin-left: 30px")

block append script
    script.
        var page_name = "task_detail";
        var d = #{task_info.duration}
        if (d < 0)
            $('#task_duration').text('Sorry, I can not tell you the task duration.');
        else {
            $('#task_duration').text(Math.floor(d / 3600) + ' 小时 ' + Math.floor((d % 3600) / 60) + ' 分钟 ' + Math.ceil(d % 60) + ' 秒');
        }

